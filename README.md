# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с TS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура

- src/components/base - базовые классы, от Яндекс Практикума
- src/components/features - функциональные классы, которые реализуют определённые фичи
- src/services - сервисы, в которые выносится логика

Приложение стартует от класса AppController при вызове метода `AppController.init()`
AppController является главным классом приложения, который отвечает за инициализацию и управление всем приложением. Он создает экземпляры других классов и сервисов, а также инициализирует их.

Как работает `AppController`:

1. AppController создает экземпляры сервисов и компонентов приложения
2. AppController инициализирует сервисы и компоненты, передавая им необходимые данные и зависимости
3. Компоненты приложения используют сервисы для получения данных и отправки запросов на сервер
4. Сервисы используют API-эндпоинты для отправки запросов на сервер и получения данных
5. Компоненты приложения отображают данные и предоставляют интерфейс пользователя

В данном проекте используется паттерн MVVM(Model-View-ViewModel):
- Model: Сервисы представляют собой модель даных приложения
- View: Компоненты приложения представляют собой вид приложения
- ViewModel: AppController и сервисы представляют прослойку между моделью и видом, которая управляет данными и событиями

Описание всех остальных классов:

Класс `ApiService` наследует базовый класс `Api` от Яндекс Практикума для того, чтобы создать прослойку, от которой можно наследоваться и не передавать каждый раз url в сервисы для работы с интернет запросами.

Классы `ApiOrderService` и `ApiProductsService` отвечают за отправку интернет запросов по заказу и по продуктам соответственно.

`StatefulEventEmitterService` - позволяет компонентам приложения обмениваться данными и событиями. Расширяет базовый класс от Яндекс Практикума `EventEmitter`. Этот расширенный EventEmiiter умеет хранить состояние по событиям и при подписке на событие будет отдаваться последние данные по этому событию

`BasketService` - прослойка связи с сервисом StatefulEventEmitterService, который работает с корзиной. Всё взаимодействие с корзиной происходит через этот сервис

`OrderService` - прослойка связи с сервисом StatefulEventEmitterService, который работает с заказом. Всё взаимодействие с заказом происходит через этот сервис

`ModalComponent` и другие компоненты являются реактивными компонентами, которые отображают данные и предоставляют интерфейс пользователя

`ModalComponent` - компонент, который реализует логику модального окна и позволяет рендерить html элементы через наследников этого класса

`GalleryComponent`- компонент, который рендерит карточки, используя публичный метод `renderProductList`. Для рендеринга карточек использует экземпляр класса `CardCatalogComponent`

`CardCatalogComponent` - компонент, который имеет публичный метод `createElement` для создания карточек, которые по итогу используются в галарее (`GalleryComponent`)

`ModalCardFullComponent` - компонент модальное окно для карточки. Имеет публичные методы `open(product: Product)`, `close` для открытия и закрытия. Перед открытием окна рендерит контент в модальном окне, ставит слушатели событий, а также отправляет данные при добавлении/удалении в корзину через сервис `BasketService`, который в свою очередь отправляет данные в `StatefulEventEmitterService`

`BasketHeaderComponent` - компонент, имеющий публичный метод `setQuantityProductsInBasket` для записи количества товаров в корзину в верхней шапки сайта

`ModalBasketComponent` - компонент модальное окно для корзины. Имеет публичные методы `open`, `close`. Перед открытием окна рендерит контент в модальном окне, ставит слушатели событий. Для рендеринга элементов в корзине использует компонент `BasketCardComponent`. Позволяет удалить элементы в корзине. Удаление происходит через `BasketService`. При непустой корине позволяет перейти на шаг составления заказа путём отправки события через `StatefulEventEmitterService`. При

`ModalEmailPhoneOrderComponent` - компонент модальное окно, первый шаг в выполнении заказа, которое позволяет ввести Email и телефон. В компоненте происходит валидация на непустые значения. При отправке данных формы происходит отправка события в сервис `StatefulEventEmitterService`, о том, что нужно открывать `ModalPaymentAddressOrderComponent`

`ModalPaymentAddressOrderComponent` - компонент модальное окно, второй шаг в выполнении заказа, которое позволяет ввести тип оплаты и адрес. В компонента происходит валидация на непустые значения. После отправки данных формы происходит отправка интернет запроса. При успешом ответе происходит отправка события в сервис `StatefulEventEmitterService` о том, что нужно открывать `ModalSuccessOrderComponent`

`ModalSuccessOrderComponent` - компонент модальное окно, которое появляется при успешном создании заказа. После закрытия окна происходит очитска данных заказа и корзины через вызовы методов сервисов - `this._orderService.clear()` и `this._basketService.clear()`

Модели данных и типы:

`ProductCategory` - тип категории продукта
`Product` - интерфейс продукта, который приходит от сервера
`Payment` - тип оплаты в заказе
`CreateOrderRequest` - интерфейс объекта даных при отправке заказа
`CreateOrderResponse` - интерфейс объекта данных при ответе сервера после отправки заказа
`GetAllProductsResponse` - интерфейс объекта данных при ответе сервера при запросе всех продуктов
`EventNames` - enum, список строк - имён события для `StatefulEventEmitterService`
`Order` - интерфейс данных заказа